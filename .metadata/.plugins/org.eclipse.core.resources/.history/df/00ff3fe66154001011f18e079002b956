package gui;

import domain.DomainController;
import javafx.geometry.Insets;
import javafx.scene.control.Label;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.VBox;

public class MainScreen extends BorderPane {
	private final DomainController dc;

	private TextArea txaCaptcha;
	private TextField txfResultSumOfDouble;
	private TextField txfResultSumOpposites;

	public MainScreen(DomainController dc) {
		this.dc = dc;
		buildGUI();
	}

	private void buildGUI() {
		buildCaptchaPane();
		buildTestPanel();
	}

	private void buildCaptchaPane() {
		VBox pane = new VBox();

		Label lblContent = new Label("Captcha content");
		txaCaptcha = new TextArea();
		txaCaptcha.setPromptText("Please enter your puzzle input");
		txaCaptcha.setWrapText(true);

		Label lblError = new Label("");
		lblError.setStyle("-fx-font-color: red;");
		txaCaptcha.setOnKeyTyped(evt -> {
			try {
				dc.enterPuzzleInput(txaCaptcha.getText());
				lblError.setText("");
				update();
			} catch (IllegalArgumentException iae) {
				lblError.setText(iae.getMessage());
			} catch (Exception e) {
				lblError.setText(String.format("%s thrown: %s", e.getClass().getSimpleName(), e.getMessage()));
			}
		});

		pane.getChildren().addAll(lblContent, txaCaptcha, lblError);
		pane.setPadding(new Insets(10));
		pane.setSpacing(10);
		setCenter(pane);
	}

	private void buildTestPanel() {
		VBox pane = new VBox();

		Label lblSumOfDouble = new Label("Sum of double digits");
		txfResultSumOfDouble = new TextField();
		txfResultSumOfDouble.setEditable(false);

		Label lblSumOpposites = new Label("Sum of opposites");
		txfResultSumOpposites = new TextField();
		txfResultSumOpposites.setEditable(false);

		pane.getChildren().addAll(lblSumOfDouble, txfResultSumOfDouble, lblSumOpposites, txfResultSumOpposites);
		pane.setPadding(new Insets(10));
		pane.setSpacing(10);
		setRight(pane);
	}

	private void update() {
		txfResultSumOfDouble.setText(Integer.toString(dc.calculateSumOfDoubleDigits()));
		txfResultSumOpposites.setText(Integer.toString(dc.calculateSumOfOpposites()));
	}

}
